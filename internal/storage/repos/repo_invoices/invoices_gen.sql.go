// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: invoices_gen.sql

package repo_invoices

import (
	"context"

	"github.com/dv-net/dv-merchant/internal/constant"
	"github.com/dv-net/dv-merchant/internal/models"
	"github.com/google/uuid"
	"github.com/jackc/pgx/v5/pgtype"
	"github.com/shopspring/decimal"
)

const create = `-- name: Create :one
INSERT INTO invoices (user_id, store_id, order_id, expected_amount_usd, received_amount_usd, status, expires_at, created_at)
	VALUES ($1, $2, $3, $4, $5, $6, $7, now())
	RETURNING id, user_id, store_id, order_id, expected_amount_usd, received_amount_usd, status, expires_at, created_at, updated_at
`

type CreateParams struct {
	UserID            uuid.UUID              `db:"user_id" json:"user_id"`
	StoreID           uuid.UUID              `db:"store_id" json:"store_id"`
	OrderID           string                 `db:"order_id" json:"order_id"`
	ExpectedAmountUsd decimal.Decimal        `db:"expected_amount_usd" json:"expected_amount_usd"`
	ReceivedAmountUsd decimal.Decimal        `db:"received_amount_usd" json:"received_amount_usd"`
	Status            constant.InvoiceStatus `db:"status" json:"status"`
	ExpiresAt         pgtype.Timestamptz     `db:"expires_at" json:"expires_at"`
}

func (q *Queries) Create(ctx context.Context, arg CreateParams) (*models.Invoice, error) {
	row := q.db.QueryRow(ctx, create,
		arg.UserID,
		arg.StoreID,
		arg.OrderID,
		arg.ExpectedAmountUsd,
		arg.ReceivedAmountUsd,
		arg.Status,
		arg.ExpiresAt,
	)
	var i models.Invoice
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.StoreID,
		&i.OrderID,
		&i.ExpectedAmountUsd,
		&i.ReceivedAmountUsd,
		&i.Status,
		&i.ExpiresAt,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return &i, err
}
